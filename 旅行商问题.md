```
//x，y中保存节点的坐标，方便计算点与点之间的距离
typedef struct TspVertex
{
    void *data;
    double x, y;
    VertexColor color;

}TspVertex;


//vertices:所有节点； tour：生成的路线，头和尾都是start形成回路 
int tsp(LIST_ATTRITIVE *vertices, const TspVertex *start, LIST_ATTRITIVE *tour, int (*match)(const void *key1, const void *key2))
{
    TspVertex *tsp_vertex, *tsp_start, *selection;
    LIST_ELEMENT *element;
    double minimum, distance, x, y;
    int found, i;

    list_init(tour, NULL);
    found = 0;

    //找到头节点，涂黑加入路径，一个一个按顺序加入路径 
    for(element = list_head(vertices); element != NULL; element = list_next(element))
    {
        tsp_vertex = list_data(element);
        if(match(tsp_vertex, start))
        { 
            list_ins_next(tour, list_tail(tour), tsp_vertex);

            tsp_start = tsp_vertex;
            tsp_vertex->color = black;
            found = 1;

            x = tsp_vertex->x;
            y = tsp_vertex->y;
        } 
        else
        {
            tsp_vertex->color = white;
        } 
    }

    if(!found)
        return -1;

    i = 0;

    //每次找到一个最近的点，涂黑 
    while(i < list_size(vertices) - 1)
    {
        minimum = DBL_MAX; 

        //找白色节点中最近的点 
        for(element = list_head(vertices); element != NULL; element = list_next(element))
        {
            tsp_vertex = list_data(element);
            if(tsp_vertex->color == white)
            {
                distance = sqrt(pow(tsp_vertex->x - x, 2.0) + pow(tsp_vertex->y - y, 2.0));

                if(distance < minimum)
                {
                    minimum = distance;
                    selection = tsp_vertex;
                } 
            }
        }

        x = selection->x;
        y = selection->y;
        selection->color = black;

        //每次插入一个点 
        if(list_ins_next(tour, list_tail(tour), selection) != 0)
        {
            list_destory(tour);
            return -1;
        }
        i++;    
    }

    //最好再插入头结点，形成回路 
    if(list_ins_next(tour, list_tail(tour), tsp_start) != 0)
    {
        list_destory(tour);
        return -1;
    }
    return 0;
}

```